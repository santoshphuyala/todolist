<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .completed {
            text-decoration: line-through;
            color: gray;
        }
    </style>
</head>
<body class="container py-5">
    <h2 class="text-center mb-4">Todo List</h2>
    <div class="input-group mb-3">
        <input type="text" id="taskInput" class="form-control" placeholder="Add a new task">
        <input type="text" id="taskDate" class="form-control" placeholder="Select date">
        <button class="btn btn-primary" onclick="addTask()">Add Task</button>
    </div>
    <ul id="taskList" class="list-group"></ul>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            loadTasks();
            let today = moment().format('YYYY-MM-DD');
            document.getElementById("taskDate").value = today;
        });

        function addTask() {
            let taskInput = document.getElementById("taskInput");
            let taskDate = document.getElementById("taskDate");
            let taskText = taskInput.value.trim();
            let dueDate = taskDate.value.trim();
            if (taskText === "" || dueDate === "") {
                alert("Please enter task and date");
                return;
            }
            let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
            tasks.push({ text: taskText, date: dueDate, completed: false });
            localStorage.setItem("tasks", JSON.stringify(tasks));
            taskInput.value = "";
            taskDate.value = moment().format('YYYY-MM-DD');
            loadTasks();
        }

        function loadTasks() {
            let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
            let taskList = document.getElementById("taskList");
            taskList.innerHTML = "";
            tasks.forEach((task, index) => {
                let taskItem = document.createElement("li");
                taskItem.className = "list-group-item d-flex justify-content-between align-items-center";
                taskItem.innerHTML = `
                    <span class="${task.completed ? 'completed' : ''}">${task.text} - ${task.date}</span>
                    <div>
                        <button class="btn btn-success btn-sm me-2" onclick="markCompleted(${index})">‚úî</button>
                        <button class="btn btn-warning btn-sm me-2" onclick="editTask(${index})">‚úè</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteTask(${index})">üóë</button>
                    </div>
                `;
                taskList.appendChild(taskItem);
            });
        }

        function markCompleted(index) {
            let tasks = JSON.parse(localStorage.getItem("tasks"));
            tasks[index].completed = !tasks[index].completed;
            localStorage.setItem("tasks", JSON.stringify(tasks));
            loadTasks();
        }

        function editTask(index) {
            let tasks = JSON.parse(localStorage.getItem("tasks"));
            let newTask = prompt("Edit Task:", tasks[index].text);
            let newDate = prompt("Edit Date (Leave blank to keep today's date):", tasks[index].date);
            if (newTask !== null) {
                tasks[index].text = newTask.trim();
                tasks[index].date = newDate.trim() !== "" ? newDate.trim() : moment().format('YYYY-MM-DD');
                localStorage.setItem("tasks", JSON.stringify(tasks));
                loadTasks();
            }
        }

        function deleteTask(index) {
            if (confirm("Are you sure you want to delete this task?")) {
                let tasks = JSON.parse(localStorage.getItem("tasks"));
                tasks.splice(index, 1);
                localStorage.setItem("tasks", JSON.stringify(tasks));
                loadTasks();
            }
        }

        $(document).ready(function() {
            $('#taskDate').datepicker({
                format: 'yyyy-mm-dd',
                autoclose: true,
                todayHighlight: true
            });
        });
    </script>
</body>
</html>
